<!DOCTYPE html>
<html lang="pt-BR" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle Financeiro Pessoal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .toast {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white min-h-full">
    <div class="container mx-auto px-4 py-6 max-w-7xl">
        <!-- CabeÃ§alho com Saldos -->
        <header class="mb-8">
            <h1 class="text-4xl font-bold text-center mb-8 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">
                ğŸ’° Controle Financeiro Pessoal
            </h1>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6">
                <div class="bg-gradient-to-r from-green-600 to-green-700 p-6 rounded-xl shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-100 text-sm">Saldo Total Geral</p>
                            <p class="text-2xl font-bold" id="saldoTotalGeral">R$ 0,00</p>
                        </div>
                        <div class="text-3xl">ğŸ’</div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-blue-600 to-blue-700 p-6 rounded-xl shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-100 text-sm">Entradas do MÃªs</p>
                            <p class="text-2xl font-bold" id="entradasMes">R$ 0,00</p>
                        </div>
                        <div class="text-3xl">ğŸ“ˆ</div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-red-600 to-red-700 p-6 rounded-xl shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-red-100 text-sm">SaÃ­das do MÃªs</p>
                            <p class="text-2xl font-bold" id="saidasMes">R$ 0,00</p>
                        </div>
                        <div class="text-3xl">ğŸ“‰</div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-purple-600 to-purple-700 p-6 rounded-xl shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-100 text-sm">Saldo do MÃªs</p>
                            <p class="text-2xl font-bold" id="saldoMes">R$ 0,00</p>
                        </div>
                        <div class="text-3xl">âš–ï¸</div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-orange-600 to-orange-700 p-6 rounded-xl shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-orange-100 text-sm">TransaÃ§Ãµes</p>
                            <p class="text-2xl font-bold" id="quantidadeTransacoes">0</p>
                        </div>
                        <div class="text-3xl">ğŸ“Š</div>
                    </div>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- FormulÃ¡rio de Nova TransaÃ§Ã£o -->
            <div class="lg:col-span-1">
                <div class="bg-slate-800/50 backdrop-blur-sm p-6 rounded-xl shadow-xl border border-slate-700">
                    <h2 class="text-2xl font-bold mb-6 flex items-center">
                        <span class="mr-2">â•</span> Nova TransaÃ§Ã£o
                    </h2>
                    
                    <form id="transactionForm" class="space-y-4">
                        <div>
                            <label for="descricao" class="block text-sm font-medium mb-2">DescriÃ§Ã£o</label>
                            <input type="text" id="descricao" required 
                                   class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label for="valor" class="block text-sm font-medium mb-2">Valor (R$)</label>
                            <input type="number" id="valor" step="0.01" required 
                                   class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label for="categoria" class="block text-sm font-medium mb-2">Categoria</label>
                            <select id="categoria" required 
                                    class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                <option value="">Selecione uma categoria</option>
                                <option value="AlimentaÃ§Ã£o">ğŸ½ï¸ AlimentaÃ§Ã£o</option>
                                <option value="Transporte">ğŸš— Transporte</option>
                                <option value="Moradia">ğŸ  Moradia</option>
                                <option value="SaÃºde">ğŸ¥ SaÃºde</option>
                                <option value="EducaÃ§Ã£o">ğŸ“š EducaÃ§Ã£o</option>
                                <option value="Lazer">ğŸ® Lazer</option>
                                <option value="SalÃ¡rio">ğŸ’¼ SalÃ¡rio</option>
                                <option value="Freelance">ğŸ’» Freelance</option>
                                <option value="Investimento">ğŸ“ˆ Investimento</option>
                                <option value="Outros">ğŸ“¦ Outros</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="tipo" class="block text-sm font-medium mb-2">Tipo</label>
                            <select id="tipo" required 
                                    class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                <option value="">Selecione o tipo</option>
                                <option value="entrada">ğŸ’° Entrada</option>
                                <option value="saida">ğŸ’¸ SaÃ­da</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="data" class="block text-sm font-medium mb-2">Data</label>
                            <input type="date" id="data" required 
                                   class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        </div>
                        
                        <button type="submit" 
                                class="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 p-3 rounded-lg font-semibold transition-all duration-200 transform hover:scale-105">
                            â• Adicionar TransaÃ§Ã£o
                        </button>
                    </form>
                </div>

                <!-- Controles de Backup -->
                <div class="bg-slate-800/50 backdrop-blur-sm p-6 rounded-xl shadow-xl border border-slate-700 mt-6">
                    <h3 class="text-xl font-bold mb-4">âš™ï¸ Controles</h3>
                    
                    <div class="space-y-3">
                        <button id="backupBtn" 
                                class="w-full bg-blue-600 hover:bg-blue-700 p-3 rounded-lg font-semibold transition-colors">
                            ğŸ’¾ Fazer Backup
                        </button>
                        
                        <div>
                            <input type="file" id="restoreFile" accept=".json" class="hidden">
                            <button id="restoreBtn" 
                                    class="w-full bg-green-600 hover:bg-green-700 p-3 rounded-lg font-semibold transition-colors">
                                ğŸ“‚ Restaurar Backup
                            </button>
                        </div>
                        
                        <button id="clearBtn" 
                                class="w-full bg-red-600 hover:bg-red-700 p-3 rounded-lg font-semibold transition-colors">
                            ğŸ—‘ï¸ Limpar Tudo
                        </button>
                    </div>
                </div>
            </div>

            <!-- VisÃ£o Geral e GrÃ¡ficos -->
            <div class="lg:col-span-2">
                <!-- Filtros -->
                <div class="bg-slate-800/50 backdrop-blur-sm p-4 rounded-xl shadow-xl border border-slate-700 mb-6">
                    <div class="flex flex-wrap items-center gap-4">
                        <label for="filtroMes" class="font-medium">ğŸ” Filtrar por:</label>
                        <select id="filtroMes" 
                                class="p-2 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-purple-500">
                            <option value="atual">MÃªs Atual</option>
                            <option value="anterior">MÃªs Anterior</option>
                            <option value="todos">Todos os Meses</option>
                        </select>
                    </div>
                </div>

                <!-- GrÃ¡ficos -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-slate-800/50 backdrop-blur-sm p-6 rounded-xl shadow-xl border border-slate-700">
                        <h3 class="text-xl font-bold mb-4 text-center">ğŸ“Š Gastos por Categoria</h3>
                        <div class="relative h-64">
                            <canvas id="categoriaChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="bg-slate-800/50 backdrop-blur-sm p-6 rounded-xl shadow-xl border border-slate-700">
                        <h3 class="text-xl font-bold mb-4 text-center">âš–ï¸ Entradas vs SaÃ­das</h3>
                        <div class="relative h-64">
                            <canvas id="entradasSaidasChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Lista de TransaÃ§Ãµes -->
                <div class="bg-slate-800/50 backdrop-blur-sm p-6 rounded-xl shadow-xl border border-slate-700">
                    <h3 class="text-xl font-bold mb-4">ğŸ“‹ HistÃ³rico de TransaÃ§Ãµes</h3>
                    <div id="transactionsList" class="space-y-2 max-h-96 overflow-y-auto">
                        <p class="text-slate-400 text-center py-8">Nenhuma transaÃ§Ã£o registrada ainda.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- Modal de ConfirmaÃ§Ã£o -->
    <div id="confirmModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-slate-800 p-6 rounded-xl shadow-xl border border-slate-700 max-w-md mx-4">
            <h3 class="text-xl font-bold mb-4">âš ï¸ ConfirmaÃ§Ã£o</h3>
            <p id="confirmMessage" class="mb-6 text-slate-300"></p>
            <div class="flex gap-4">
                <button id="confirmYes" class="flex-1 bg-red-600 hover:bg-red-700 p-3 rounded-lg font-semibold transition-colors">
                    Sim, confirmar
                </button>
                <button id="confirmNo" class="flex-1 bg-slate-600 hover:bg-slate-700 p-3 rounded-lg font-semibold transition-colors">
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <script>
        class FinanceManager {
            constructor() {
                this.transactions = JSON.parse(localStorage.getItem('transactions')) || [];
                this.saldoTotalGeral = parseFloat(localStorage.getItem('saldoTotalGeral')) || 0;
                this.currentFilter = 'atual';
                this.categoriaChart = null;
                this.entradasSaidasChart = null;
                
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.setCurrentDate();
                this.updateDisplay();
                this.initCharts();
                this.checkMonthChange();
            }

            setupEventListeners() {
                document.getElementById('transactionForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addTransaction();
                });

                document.getElementById('filtroMes').addEventListener('change', (e) => {
                    this.currentFilter = e.target.value;
                    this.updateDisplay();
                });

                document.getElementById('backupBtn').addEventListener('click', () => this.exportBackup());
                document.getElementById('restoreBtn').addEventListener('click', () => document.getElementById('restoreFile').click());
                document.getElementById('restoreFile').addEventListener('change', (e) => this.importBackup(e));
                document.getElementById('clearBtn').addEventListener('click', () => this.confirmClearAll());

                document.getElementById('confirmYes').addEventListener('click', () => this.clearAll());
                document.getElementById('confirmNo').addEventListener('click', () => this.hideConfirmModal());
            }

            setCurrentDate() {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('data').value = today;
            }

            checkMonthChange() {
                const lastMonth = localStorage.getItem('lastMonth');
                const currentMonth = new Date().getMonth();
                
                if (lastMonth && parseInt(lastMonth) !== currentMonth) {
                    // Novo mÃªs detectado - nÃ£o zerar dados, apenas atualizar referÃªncia
                    localStorage.setItem('lastMonth', currentMonth.toString());
                } else if (!lastMonth) {
                    localStorage.setItem('lastMonth', currentMonth.toString());
                }
            }

            addTransaction() {
                const descricao = document.getElementById('descricao').value;
                const valor = parseFloat(document.getElementById('valor').value);
                const categoria = document.getElementById('categoria').value;
                const tipo = document.getElementById('tipo').value;
                const data = document.getElementById('data').value;

                const transaction = {
                    id: Date.now(),
                    descricao,
                    valor,
                    categoria,
                    tipo,
                    data,
                    timestamp: new Date().toISOString()
                };

                this.transactions.push(transaction);
                
                // Atualizar saldo total geral
                if (tipo === 'entrada') {
                    this.saldoTotalGeral += valor;
                } else {
                    this.saldoTotalGeral -= valor;
                }

                this.saveData();
                this.updateDisplay();
                this.clearForm();
                this.showToast('TransaÃ§Ã£o adicionada com sucesso!', 'success');
            }

            clearForm() {
                document.getElementById('transactionForm').reset();
                this.setCurrentDate();
            }

            getFilteredTransactions() {
                const now = new Date();
                const currentMonth = now.getMonth();
                const currentYear = now.getFullYear();

                switch (this.currentFilter) {
                    case 'atual':
                        return this.transactions.filter(t => {
                            const transactionDate = new Date(t.data);
                            return transactionDate.getMonth() === currentMonth && 
                                   transactionDate.getFullYear() === currentYear;
                        });
                    case 'anterior':
                        const previousMonth = currentMonth === 0 ? 11 : currentMonth - 1;
                        const previousYear = currentMonth === 0 ? currentYear - 1 : currentYear;
                        return this.transactions.filter(t => {
                            const transactionDate = new Date(t.data);
                            return transactionDate.getMonth() === previousMonth && 
                                   transactionDate.getFullYear() === previousYear;
                        });
                    case 'todos':
                        return this.transactions;
                    default:
                        return this.transactions;
                }
            }

            getCurrentMonthTransactions() {
                const now = new Date();
                const currentMonth = now.getMonth();
                const currentYear = now.getFullYear();
                
                return this.transactions.filter(t => {
                    const transactionDate = new Date(t.data);
                    return transactionDate.getMonth() === currentMonth && 
                           transactionDate.getFullYear() === currentYear;
                });
            }

            updateDisplay() {
                const filteredTransactions = this.getFilteredTransactions();
                const currentMonthTransactions = this.getCurrentMonthTransactions();

                // Calcular totais do mÃªs atual
                const entradasMes = currentMonthTransactions
                    .filter(t => t.tipo === 'entrada')
                    .reduce((sum, t) => sum + t.valor, 0);

                const saidasMes = currentMonthTransactions
                    .filter(t => t.tipo === 'saida')
                    .reduce((sum, t) => sum + t.valor, 0);

                const saldoMes = entradasMes - saidasMes;
                const quantidadeTransacoes = currentMonthTransactions.length;

                // Atualizar elementos do DOM
                document.getElementById('saldoTotalGeral').textContent = this.formatCurrency(this.saldoTotalGeral);
                document.getElementById('entradasMes').textContent = this.formatCurrency(entradasMes);
                document.getElementById('saidasMes').textContent = this.formatCurrency(saidasMes);
                document.getElementById('saldoMes').textContent = this.formatCurrency(saldoMes);
                document.getElementById('quantidadeTransacoes').textContent = quantidadeTransacoes;

                // Atualizar cor do saldo do mÃªs
                const saldoMesElement = document.getElementById('saldoMes');
                saldoMesElement.className = saldoMes >= 0 ? 'text-2xl font-bold text-green-300' : 'text-2xl font-bold text-red-300';

                this.updateTransactionsList(filteredTransactions);
                this.updateCharts(filteredTransactions);
            }

            updateTransactionsList(transactions) {
                const container = document.getElementById('transactionsList');
                
                if (transactions.length === 0) {
                    container.innerHTML = '<p class="text-slate-400 text-center py-8">Nenhuma transaÃ§Ã£o encontrada para o perÃ­odo selecionado.</p>';
                    return;
                }

                const sortedTransactions = transactions.sort((a, b) => new Date(b.data) - new Date(a.data));
                
                container.innerHTML = sortedTransactions.map(transaction => `
                    <div class="bg-slate-700/50 p-4 rounded-lg border border-slate-600 fade-in">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="font-semibold">${transaction.descricao}</span>
                                    <span class="text-xs bg-slate-600 px-2 py-1 rounded">${transaction.categoria}</span>
                                </div>
                                <p class="text-sm text-slate-400">${this.formatDate(transaction.data)}</p>
                            </div>
                            <div class="text-right">
                                <p class="font-bold ${transaction.tipo === 'entrada' ? 'text-green-400' : 'text-red-400'}">
                                    ${transaction.tipo === 'entrada' ? '+' : '-'} ${this.formatCurrency(transaction.valor)}
                                </p>
                                <button onclick="financeManager.removeTransaction(${transaction.id})" 
                                        class="text-xs text-red-400 hover:text-red-300 mt-1">
                                    ğŸ—‘ï¸ Remover
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            removeTransaction(id) {
                const transaction = this.transactions.find(t => t.id === id);
                if (transaction) {
                    // Reverter do saldo total geral
                    if (transaction.tipo === 'entrada') {
                        this.saldoTotalGeral -= transaction.valor;
                    } else {
                        this.saldoTotalGeral += transaction.valor;
                    }

                    this.transactions = this.transactions.filter(t => t.id !== id);
                    this.saveData();
                    this.updateDisplay();
                    this.showToast('TransaÃ§Ã£o removida com sucesso!', 'success');
                }
            }

            initCharts() {
                const ctx1 = document.getElementById('categoriaChart').getContext('2d');
                const ctx2 = document.getElementById('entradasSaidasChart').getContext('2d');

                this.categoriaChart = new Chart(ctx1, {
                    type: 'doughnut',
                    data: {
                        labels: ['Nenhum dado'],
                        datasets: [{
                            data: [1],
                            backgroundColor: ['#64748B'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { 
                                    color: '#E2E8F0',
                                    font: { size: 12 }
                                }
                            },
                            tooltip: {
                                enabled: true,
                                backgroundColor: '#1E293B',
                                titleColor: '#E2E8F0',
                                bodyColor: '#E2E8F0',
                                borderColor: '#475569',
                                borderWidth: 1
                            }
                        },
                        cutout: '60%'
                    }
                });

                this.entradasSaidasChart = new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Entradas', 'SaÃ­das'],
                        datasets: [{
                            data: [1, 1],
                            backgroundColor: ['#10B981', '#EF4444'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { 
                                    color: '#E2E8F0',
                                    font: { size: 12 }
                                }
                            },
                            tooltip: {
                                enabled: true,
                                backgroundColor: '#1E293B',
                                titleColor: '#E2E8F0',
                                bodyColor: '#E2E8F0',
                                borderColor: '#475569',
                                borderWidth: 1,
                                callbacks: {
                                    label: function(context) {
                                        const value = context.parsed;
                                        return context.label + ': R$ ' + value.toLocaleString('pt-BR', {
                                            minimumFractionDigits: 2,
                                            maximumFractionDigits: 2
                                        });
                                    }
                                }
                            }
                        },
                        cutout: '60%'
                    }
                });
            }

            updateCharts(transactions) {
                // GrÃ¡fico por categoria (apenas saÃ­das)
                const saidas = transactions.filter(t => t.tipo === 'saida');
                const categorias = {};
                
                saidas.forEach(t => {
                    categorias[t.categoria] = (categorias[t.categoria] || 0) + t.valor;
                });

                const cores = [
                    '#8B5CF6', '#EC4899', '#06B6D4', '#10B981',
                    '#F59E0B', '#EF4444', '#6366F1', '#84CC16',
                    '#F97316', '#64748B'
                ];

                if (Object.keys(categorias).length > 0) {
                    this.categoriaChart.data.labels = Object.keys(categorias);
                    this.categoriaChart.data.datasets[0].data = Object.values(categorias);
                    this.categoriaChart.data.datasets[0].backgroundColor = cores.slice(0, Object.keys(categorias).length);
                } else {
                    this.categoriaChart.data.labels = ['Nenhum gasto registrado'];
                    this.categoriaChart.data.datasets[0].data = [1];
                    this.categoriaChart.data.datasets[0].backgroundColor = ['#64748B'];
                }
                this.categoriaChart.update('none');

                // GrÃ¡fico entradas vs saÃ­das
                const totalEntradas = transactions
                    .filter(t => t.tipo === 'entrada')
                    .reduce((sum, t) => sum + t.valor, 0);
                
                const totalSaidas = transactions
                    .filter(t => t.tipo === 'saida')
                    .reduce((sum, t) => sum + t.valor, 0);

                if (totalEntradas > 0 || totalSaidas > 0) {
                    this.entradasSaidasChart.data.datasets[0].data = [totalEntradas, totalSaidas];
                    this.entradasSaidasChart.data.datasets[0].backgroundColor = ['#10B981', '#EF4444'];
                } else {
                    this.entradasSaidasChart.data.datasets[0].data = [1, 1];
                    this.entradasSaidasChart.data.datasets[0].backgroundColor = ['#475569', '#475569'];
                }
                this.entradasSaidasChart.update('none');
            }

            exportBackup() {
                const data = {
                    transactions: this.transactions,
                    saldoTotalGeral: this.saldoTotalGeral,
                    exportDate: new Date().toISOString()
                };

                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `backup-financeiro-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);

                this.showToast('Backup exportado com sucesso!', 'success');
            }

            importBackup(event) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        if (data.transactions && Array.isArray(data.transactions)) {
                            this.transactions = data.transactions;
                            this.saldoTotalGeral = data.saldoTotalGeral || 0;
                            this.saveData();
                            this.updateDisplay();
                            this.showToast('Backup restaurado com sucesso!', 'success');
                        } else {
                            this.showToast('Arquivo de backup invÃ¡lido!', 'error');
                        }
                    } catch (error) {
                        this.showToast('Erro ao ler o arquivo de backup!', 'error');
                    }
                };
                reader.readAsText(file);
                
                // Limpar o input
                event.target.value = '';
            }

            confirmClearAll() {
                document.getElementById('confirmMessage').textContent = 
                    'Tem certeza que deseja apagar todas as transaÃ§Ãµes e reiniciar o sistema? Esta aÃ§Ã£o nÃ£o pode ser desfeita.';
                document.getElementById('confirmModal').classList.remove('hidden');
                document.getElementById('confirmModal').classList.add('flex');
            }

            hideConfirmModal() {
                document.getElementById('confirmModal').classList.add('hidden');
                document.getElementById('confirmModal').classList.remove('flex');
            }

            clearAll() {
                this.transactions = [];
                this.saldoTotalGeral = 0;
                this.saveData();
                this.updateDisplay();
                this.hideConfirmModal();
                this.showToast('Todos os dados foram apagados!', 'success');
            }

            saveData() {
                localStorage.setItem('transactions', JSON.stringify(this.transactions));
                localStorage.setItem('saldoTotalGeral', this.saldoTotalGeral.toString());
            }

            formatCurrency(value) {
                return new Intl.NumberFormat('pt-BR', {
                    style: 'currency',
                    currency: 'BRL'
                }).format(value);
            }

            formatDate(dateString) {
                return new Date(dateString).toLocaleDateString('pt-BR');
            }

            showToast(message, type = 'success') {
                const toast = document.createElement('div');
                toast.className = `toast p-4 rounded-lg shadow-lg text-white ${
                    type === 'success' ? 'bg-green-600' : 'bg-red-600'
                }`;
                toast.textContent = message;

                document.getElementById('toastContainer').appendChild(toast);

                setTimeout(() => {
                    toast.remove();
                }, 3000);
            }
        }

        // Inicializar o sistema
        const financeManager = new FinanceManager();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9924e65227382800',t:'MTc2MTA5MzE2OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
